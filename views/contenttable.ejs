  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>



<div class="container mx-auto px-4 ">
  <h1 class="text-2xl  mb-6">Customer Data</h1>
  <div class="mb-6">
    <button class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
      </svg>
      Add New User
    </button>
  </div>

  <div class="overflow-x-auto">
    <table class="min-w-full bg-white border border-gray-200">
      <thead>
        <tr>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Image</th>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Room</th>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Name</th>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Citizen ID</th>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Phone</th>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Car Info</th>
          <th class="py-2 px-4 border-b text-left font-semibold text-gray-700">Actions</th>
        </tr>
      </thead>
      <tbody id="dataTableBody">
        <!-- Example row -->
         
       
        <tr>
   
        </tr>
        
      </tbody>
    </table>
  </div>
</div>


<!-- Modal Add -->
<div id="addModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden overflow-y-auto h-full w-full">
  <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
    <div class="mt-3">
      <h3 class="text-lg leading-6 font-medium text-gray-900">Add New User</h3>
      <form id="addUserForm" class="mt-4" enctype="multipart/form-data">
        <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="image">
            Image
          </label>
          <input type="file" 
                 id="image" 
                 name="image"
                 accept="image/*"
                 class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                 required>
        </div>

        <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="room">
            Room Number
          </label>
          <input type="number" 
                 id="room" 
                 name="room"
                 class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                 required>
        </div>

        <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
            Name
          </label>
          <input type="text" 
                 id="name" 
                 name="name"
                 class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                 required>
        </div>

        <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="citizenid">
            Citizen ID
          </label>
          <input type="text" 
                 id="citizenid" 
                 name="citizenid"
                 class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                 required>
        </div>

        <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="tel">
            Phone Number
          </label>
          <input type="tel" 
                 id="tel" 
                 name="tel"
                 class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                 required>
        </div>

        <div class="mb-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="carinfo">
            Car Information
          </label>
          <input type="text" 
                 id="carinfo" 
                 name="carinfo"
                 class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                 required>
        </div>

        <div class="flex items-center justify-between mt-6">
          <button type="submit" 
                  class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
            Save
          </button>
          <button type="button"
                  onclick="closeAddModal()"
                  class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


<script>
// Show modal when Add New User button is clicked
document.querySelector('.bg-green-500').addEventListener('click', () => {
  document.getElementById('addModal').classList.remove('hidden');
});

// Close modal function
function closeAddModal() {
  document.getElementById('addModal').classList.add('hidden');
}

// Handle form submission
document.getElementById('addUserForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const formData = new FormData(e.target);
  
  try {
    const response = await axios.post('/api/users', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    });
    
    if(response.status === 201) {
      alert('User added successfully!');
      closeAddModal();
      location.reload(); // Refresh the page to show new data
    }
  } catch (error) {
    console.error('Error:', error);
    alert('Failed to add user. Please try again.');
  }
});


// Get data from API and populate table
const getData = async () => {
  try {
    const response = await axios.get('/api/users');
    const users = response.data;
    const tableBody = document.getElementById('dataTableBody');
    tableBody.innerHTML = ''; // Clear existing rows

    users.forEach(user => {
      const row = `
        <tr>
          <td class="py-2 px-4 border-b">
            <img style="width: 50px; height: 50px; object-fit: cover; border-radius: 50%;" src="${user.image}" alt="User Image" class="w-16 h-16 object-cover rounded-md">
          </td>
          <td class="py-2 px-4 border-b">${user.room}</td>
          <td class="py-2 px-4 border-b">${user.name}</td>
          <td class="py-2 px-4 border-b">${user.citizenid}</td>
          <td class="py-2 px-4 border-b">${user.tel}</td>
          <td class="py-2 px-4 border-b">${user.carinfo}</td>
          <td class="py-2 px-4 border-b">
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded">Edit</button>
            <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded">Delete</button>
          </td>
        </tr>
      `;
      tableBody.innerHTML += row;
    });
  } catch (error) {
    console.error('Error fetching data:', error);
  }
};

// Load data when page loads
document.addEventListener('DOMContentLoaded', getData);

</script>


